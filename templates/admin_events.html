{% extends "admin_base.html" %}

{% block admin_content %}
  <h1 class="page-title">Events</h1>

  <!-- Add New Event -->
  <form method="post">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    <input type="hidden" name="action" value="add">
    <input name="title" placeholder="Event Title" required><br>
    <input type="date" name="date"><br>
    <textarea name="description" placeholder="Description"></textarea><br>
    <label><input type="checkbox" name="pinned" value="1"> Recurring (won't expire)</label><br>
    <button type="submit">Add Event</button>
  </form>

  <hr>

  <h2>Current Events</h2>
  {% for event in events %}
    <form method="post" style="margin-bottom: 1rem;">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <input type="hidden" name="index" value="{{ loop.index0 }}">
      <input name="title" value="{{ event.title }}">
      <input type="date" name="date" value="{{ event.date if not event.get('pinned') else '' }}"><br>
      <textarea name="description">{{ event.description }}</textarea><br>
      <label><input type="checkbox" name="pinned" value="1" {% if event.get('pinned') %}checked{% endif %}> Recurring (won't expire)</label><br>
      <button type="submit" name="action" value="update">Update</button>
      <button type="submit" name="action" value="delete" onclick="return confirm('Delete this event?')">Delete</button>
    </form>
  {% endfor %}
{% endblock %}
